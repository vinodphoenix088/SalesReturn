<style>
    div.scrollmenu {
        overflow: auto;
        white-space: nowrap;
    }

        div.scrollmenu a {
            display: inline-block;
            color: white;
            text-align: center;
            text-decoration: none;
        }

            div.scrollmenu a:hover {
                background-color: #777;
            }

    th {
        text-align: center;
    }

    .table > thead > tr > th {
        vertical-align: top;
    }

    #myInput {
        padding: 20px;
        margin-top: -6px;
        border: 0;
        border-radius: 0;
        background: #f1f1f1;
    }

    .box.box-primary {
        border-top-color: #14448a;
    }

    thead {
        white-space: nowrap;
        padding: 15px !important;
        background: #14448a;
        color: white;
    }
</style>
<section class="content">
    <div class="row">
        <div class="col-md-12">
            <div class="box box-primary">
                <div class="box-header with-border" style="color:black;">

                    <div style="text-align:center;">
                        <h3 class="box-title">
                            Pending Billing Closure<a ng-click="init()" title="Refresh" style="color: blue; cursor: pointer"><i class="fa fa-fw fa-refresh"></i></a>
                        </h3>
                    </div><!--col end-->
                </div>
                <!-- /.box-header -->
                <!-- form start -->
                <form role="form">
                    <div class="box-body">
                        <div ng-hide="showView==true">
                            <div class="table-responsive">

                                <table id="example2" class="table table-bordered table-hover">
                                    <thead>
                                        <tr>
                                            <th>S.No</th>
                                            <th>Request No.</th>
                                            <th>Depot</th>
                                            <th>
                                                Dealer
                                            </th>
                                            <!--  <th>Reason For Return</th>-->
                                            <th>
                                                Total SRV Value
                                            </th>
                                            <th>
                                                Requested By
                                            </th>
                                            <th>
                                                Requested Date
                                            </th>
                                            <th>
                                                Status
                                            </th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody ng-repeat="pt in ApprovedRequestList">
                                        <tr>
                                            <td>
                                                {{ $index + 1 }}

                                            </td>
                                            <td>

                                                {{pt.RequestTypeOption}}-{{ pt.RequestHeaderId }}
                                            </td>
                                            <td>
                                                {{pt.DepotName}} : {{pt.DepotCode}}
                                            </td>
                                            <td>
                                                {{pt.DealerName}} :  {{pt.DealerCode}}
                                            </td>
                                            <td>
                                                {{pt.TotalSRV}}
                                            </td>
                                            <td>
                                                {{pt.CreatedBy}} : {{pt.CreatedBy_EMP_CODE}}
                                            </td>
                                            <td>
                                                {{pt.CreatedDate | date : 'dd MMM yyyy'}}
                                            </td>

                                            <td>
                                                <a href ng-click="openStatus(pt.RequestHeaderId,pt.RequestTypeOption)"><span class="badge">{{ pt.FutureStatus }}</span></a>
                                            </td>
                                            <td>
                                                <button class="btn btn-primary btn-xs" ng-click="ViewRequestDetails(pt.RequestHeaderId ,pt.CurrentStatus_Id , pt.FutureStatus_Id , pt)">
                                                    View Detail
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>


                            </div>
                        </div>
                    </div>
                    <div ng-show="showView==true">

                        <div class="box-body">
                            <div class="table-responsive">
                                <div>
                                    <table class="table table-bordered table-hover">
                                        <thead>
                                            <tr>
                                                <th>Request No</th>
                                                <th>Depot Name</th>
                                                <th>
                                                    Dealer Name &amp; Code
                                                </th>
                                                <th>
                                                    Reason for Return
                                                </th>
                                                <th>
                                                    Total SRV
                                                </th>
                                                <th>
                                                    Requested Date
                                                </th>

                                                <th>
                                                    Requested By
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <th>{{ ApprovedRequestDetails.RequestTypeOption }}-{{ApprovedRequestDetails.RequestHeader_Id}}</th>
                                                <th>{{ ApprovedRequestDetails.DepotName }}</th>
                                                <th>{{ ApprovedRequestDetails.DealerName }}</th>
                                                <th>{{ ApprovedRequestDetails.ReasonForReturn }}</th>
                                                <th>{{ TotalSRV_ }}</th>
                                                <th>{{ CreatedDate_ | date : 'dd MMM yyyy'}}</th>
                                                <th>{{ CreatedBy_ }}</th>

                                            </tr>
                                        </tbody>

                                    </table>
                                </div>
                            </div>
                        </div>

                        <div class="box-body">
                            <div class="table-responsive">
                                <div style="min-height: 300px; ">
                                    <table id="Table1" class="table table-bordered table-hover">
                                        <thead>
                                            <tr>
                                                <th>S.No</th>
                                                <th>
                                                    Invoice
                                                    Number
                                                </th>
                                                <th>
                                                    Invoice
                                                    Date
                                                </th>
                                                <th>
                                                    Dealer Is ready to
                                                    provide GST invoice
                                                </th>
                                                <th>
                                                    Invoice
                                                    Upload
                                                </th>
                                                <th>
                                                    SKU
                                                    Code
                                                </th>
                                                <th>
                                                    SKU
                                                    Name
                                                </th>
                                                <th>
                                                    Batch
                                                    No.
                                                </th>
                                                <th>
                                                    Manufacturing Date

                                                </th>
                                                <th>
                                                    Shelf Life
													(In Days)
                                                </th>
                                                <th>
                                                    Invoice
                                                    Quantity
                                                </th>
                                                <th>
                                                    SRV
                                                    Quantity
                                                </th>
                                                <th>
                                                    Unit
                                                </th>
                                                <th>
                                                    Pack
                                                    Size
                                                </th>
                                                <th>
                                                    Volume
                                                </th>
                                                <th>
                                                    SRV
                                                    Value (In INR)
                                                </th>
                                                <th ng-if="ApprovedRequestDetails.ReasonForReturn_Id  == 1">
                                                    CC
                                                    No.
                                                </th>
                                                <th>
                                                    Sub Reason
                                                </th>
                                                <th>
                                                    Remarks
                                                </th>
                                                <th>
                                                    Received
                                                </th>
                                                <th ng-hide="FutureStatus_Id==10021 || CurrentStatus_Id==10024 || CurrentStatus_Id==10023">
                                                    Short
                                                </th>
                                                <th ng-hide="FutureStatus_Id==10021 || CurrentStatus_Id==10024 || CurrentStatus_Id==10023">
                                                    Excess
                                                </th>
                                                <th>
                                                    Damaged(In Receive)
                                                </th>
                                                <th ng-hide="FutureStatus_Id==10019">
                                                    Reason for SAP
                                                </th>
                                                <th ng-if="CurrentStatus_Id==10023||FutureStatus_Id==10021||CurrentStatus_Id==10032||CurrentStatus_Id==10024">
                                                    DO No.
                                                </th>
                                                <th ng-if="FutureStatus_Id == 10021 ||CurrentStatus_Id==10024">
                                                    Release
                                                </th>
                                                <th ng-if=" FutureStatus_Id == 10019 && CurrentStatus_Id==10024">
                                                    SRV Invoince NO.
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="Obj in ApprovedRequestDetails.RequestDetail">
                                                <td>
                                                    {{ $index + 1 }}
                                                <td>
                                                    {{ Obj.InvoiceNo }}
                                                </td>
                                                <td>
                                                    <!-- <input type="date" ng-model="Obj.InvoiceDate" class="form-control pull-right" id="datepicker" style="width: 155px;">-->
                                                    {{ Obj.InvoiceDate | date : 'dd MMM yyyy' }}
                                                </td>

                                                <td>
                                                    <span ng-if="Obj.ProvideGST_Yes">
                                                        Yes
                                                    </span>
                                                    <span ng-if="!Obj.ProvideGST_Yes">-</span>
                                                </td>
                                                <td>
                                                    <span ng-if="Obj.ProvideGST_Yes">
                                                        <a ng-href="../{{Obj.UploadedInvoice}}" target="_blank">{{ Obj.UploadedInvoice }}</a>
                                                    </span>
                                                    <span ng-if="!Obj.ProvideGST_Yes">
                                                        -
                                                    </span>
                                                </td>
                                                <td>
                                                    {{ Obj.SKUCode }}
                                                </td>
                                                <td>
                                                    {{ Obj.SKUName}}
                                                </td>
                                                <td>
                                                    {{ Obj.BatchNo }}
                                                </td>
                                                <td>
                                                    {{ Obj.Manufacturing_Date | date : 'dd MMM yyyy' }}
                                                </td>
                                                <td>
                                                    {{ Obj.Shelf_Life }}
                                                </td>
                                                <td>
                                                    {{ Obj.InvoiceQuantity }}

                                                </td>
                                                <td>{{ Obj.SRVQuantity }}</td>
                                                <td>{{ Obj.Unit }}</td>
                                                <td>{{ Obj.PackSize }}</td>
                                                <td>{{ Obj.SRVQuantity  *  Obj.PackSize }}</td>
                                                <td>
                                                    {{ Obj.SRVValue }}
                                                </td>
                                                <td ng-if="ApprovedRequestDetails.ReasonForReturn_Id  == 1">
                                                    {{ Obj.ComplaintNumber }}
                                                </td>
                                                <td>
                                                    <span ng-hide="FutureStatus_Id==10019&&CurrentStatus_Id==16">{{ Obj.SubReasonName }}</span>
                                                    <select ng-show="FutureStatus_Id==10019&&CurrentStatus_Id==16" type="text" ng-model="Obj.SubReason" ng-options="pt.salesReasonId as pt.SubReason for pt in SubReasonList" class="form-control"
                                                            style="width: 65px;padding: initial;"></select>
                                                </td>
                                                <td>
                                                    {{ Obj.Remarks }}
                                                </td>
                                                <td>
                                                    <span ng-hide="FutureStatus_Id==10019&&CurrentStatus_Id==16">{{Obj.ReceivedQuantity-Obj.Excess}}</span>
                                                    <input ng-show="FutureStatus_Id==10019&&CurrentStatus_Id==16" type="text" class="form-control" ng-model="Obj.ReceivedQuantity" style="width: 65px;" ng-change="ReadRecvdQuantity()" numbers-only>
                                                </td>
                                                <td ng-hide="FutureStatus_Id==10021 || CurrentStatus_Id==10024|| CurrentStatus_Id==10023 ">
                                                    <p style="width: 65px;" ng-model="Obj.Short" ng-if="Obj.Short>=0">{{Obj.Short}}</p>
                                                </td>
                                                <td ng-hide="FutureStatus_Id==10021 || CurrentStatus_Id==10024 || CurrentStatus_Id==10023">
                                                    <p style="width: 65px;" ng-model="Obj.Excess" ng-if="Obj.Excess>=0">{{Obj.Excess}}</p>
                                                </td>

                                                <td>
                                                    <span ng-hide="FutureStatus_Id==10019 && CurrentStatus_Id==16">{{Obj.Damaged}}</span>
                                                    <input ng-show="FutureStatus_Id==10019 && CurrentStatus_Id==16" type="text" class="form-control" ng-model="Obj.Damaged" style="width: 65px;" numbers-only>
                                                </td>
                                                <td ng-hide="FutureStatus_Id==10019">
                                                    <!--ng-hide="FutureStatus_Id==10019"-->
                                                    <div class="form-group" style="width: 65px;">
                                                        <!--ng-disabled="FutureStatus_Id != 10020"-->
                                                        <select class="form-control" ng-disabled="Obj.SAPsubReasonID" ng-model="Obj.SAPsubReasonID" ng-options="pt.SAPReasonID as pt.SAPSubReasons for pt in SAPReasonList"></select>
                                                    </div>
                                                </td>
                                                <td ng-if="CurrentStatus_Id==10023|| FutureStatus_Id==10021 ||CurrentStatus_Id==10032||CurrentStatus_Id==10024">
                                                    <input ng-if="CurrentStatus_Id==10023||CurrentStatus_Id==10032" type="text" ng-model="Obj.DONo" class="form-control" style="width: 65px;" numbers-only>
                                                    <p ng-if="CurrentStatus_Id!=10023 &&CurrentStatus_Id!=10032">{{Obj.DONo}}</p> <!--|| CurrentStatus_Id==10024-->
                                                </td>
                                                <!--<td ng-if="FutureStatus_Id == 10021||CurrentStatus_Id==10024">-->
                                                <td ng-if="FutureStatus_Id == 10021||CurrentStatus_Id==10024">
                                                    <!--<input ng-disabled="CurrentStatus_Id==10024" type="checkbox" ng-model="Obj.ReleaseByCM" style="width: 65px;">-->
                                                    <input ng-disabled="Obj.ReleaseByCM" type="checkbox" ng-model="Obj.ReleaseByCM" style="width: 65px;">
                                                </td>
                                                <td ng-if=" FutureStatus_Id == 10019 && CurrentStatus_Id==10024">
                                                    <input type="text" ng-model="Obj.SRVInvoiceNo" style="width: 65px;">
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div><!--table responsive-->
                            </div>
                        </div>
                    </div>

                    <div style="padding:10px" ng-show="showView==true">
                        <div class="row">
                            <label style="padding:10px" for="sel1">Remark:</label>
                        </div>
                        <div class="row" style="padding:10px">
                            <textarea ng-model="Remarks" class="form-control ng-pristine ng-valid ng-empty ng-touched" style="width:40%;height:80px; padding:10px"></textarea>
                        </div>
                    </div>
                    <div class="box-body" ng-show="showView==true">
                        <div class="table-responsive">
                            <table class="table table-bordered table-hover">
                                <thead class="thead-inverse">
                                    <tr style="text-align: center;">
                                        <th>Role</th>
                                        <th>Employee Details</th>
                                        <th>Status</th>
                                        <th>Date</th>
                                        <th>Remark</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="item in grid" style="text-align: center;">
                                        <td>{{item.Department}}</td>
                                        <td>
                                            <span ng-if="item.EMP_CODE">{{item.Emp_First_name}} : {{item.EMP_CODE}}</span>

                                            <!--<label ng-if="item.Status == 'null'">Catalyst Team</label>-->
                                            <!--<label ng-if="item.Status != 'Pending - Catalyst' && item.Status != 'Pending - Catalyst'">{{item.EMP_CODE}} : {{item.Emp_First_name}}</label>-->
                                        </td>
                                        <td>{{item.Status}}</td>
                                        <td>{{item.Added_Date | date:'dd-MM-yyyy'}}</td>
                                        <td>{{item.Remark}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="box-footer" ng-show="showView==true">
                        <button class="btn btn-primary btn-xs pull-right" ng-click="showView=false" style="margin-top:10px; margin-left: 5px;">Back</button>

                        <button ng-if="FutureStatus_Id == 10021" class="btn btn-warning btn-xs pull-right" ng-click="ReconsiderByCommercial(ApprovedRequestDetails)" style="margin-top:10px;margin-left:5px;">Reconsider</button><!--Acknowledge by Commercial-->
                        <button ng-if="FutureStatus_Id == 10019 && CurrentStatus_Id==16" class="btn btn-success btn-xs pull-right" ng-click="AcknowledgeByDepot(ApprovedRequestDetails)" style="margin-top:10px;margin-right:5px;">Acknowledge</button>
                        <button ng-if="CurrentStatus_Id==10023||CurrentStatus_Id==10032" class="btn btn-success btn-xs pull-right" ng-click="updateDoNumber(ApprovedRequestDetails)" style="margin-top:10px;margin-left:5px;">Submit</button><!--Update By CSO-->
                        <button ng-if="FutureStatus_Id == 10020" class="btn btn-success btn-xs pull-right" ng-click="updateDetail(ApprovedRequestDetails)" style="margin-top:10px;margin-left:5px;">Submit</button><!--Update By CSO-->
                        <button ng-if="FutureStatus_Id == 10021" class="btn btn-success btn-xs pull-right" ng-click="ackByCommercial(ApprovedRequestDetails)" style="margin-top:10px;margin-left:5px;">Release</button><!--Acknowledge by Commercial-->
                        <button ng-if="FutureStatus_Id == 10019 && CurrentStatus_Id==10024" class="btn btn-success btn-xs pull-right" ng-click="ApproveByDepot(ApprovedRequestDetails)" style="margin-top:10px;margin-left:5px;">Submit</button><!--Approve By Depot-->
                    </div>
                </form>
            </div><!--primary-->
        </div><!--cole dn-->
    </div><!--row end-->
</section>

<script>
    $(document).ready(function () {
        $("#myInput").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $(".dropdown-menu li").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });
</script>